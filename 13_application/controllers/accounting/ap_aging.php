<?php defined('BASEPATH') OR exit('No direct script access allowed');class ap_aging extends CI_Controller {	public function __construct(){		parent::__construct();				$this->lib_auth->default = "default-accounting";		$this->load->model('accounting/md_ap_aging');	}	public function index($id=null){				$this->lib_auth->title = "A/P Aging Report";				$this->lib_auth->build = "accounting/ap_aging/vw_ap_aging";		$this->lib_auth->render();	}	public function suppliers(){		$data = $this->input->post();		$result = $this->md_ap_aging->suppliers($data['checked'],$data['Main']);		if($result)			echo json_encode($result);		else			return false;			}		public function get_cumulative(){		if(!$this->input->is_ajax_request()){			exit(0);		}					$result = $this->md_ap_aging->All_Data();		$table = null;$total=0;$current=0;$one_to_thirty=0;$thirthy1_to_sixty=0;$sixty1_to_ninety=0;$ninety_plus=0;		if($result){			foreach($result as $i){				$total+=$i['TOTAL'];				$current+=$i['CURRENT'];				$one_to_thirty+=$i['1-30'];				$thirthy1_to_sixty+=$i['31-60'];				$sixty1_to_ninety+=$i['61-90'];				$ninety_plus+=$i['90+'];			}			$array = array ('SUPPLIER',							'CURRENT',							'1-30',							'31-60',							'61-90',							'90+',							'TOTAL');			$data = array( '0'=>number_format($total, 2, '.', ','),							'1'=>number_format($current, 2, '.', ','),							'2'=>number_format($one_to_thirty, 2, '.', ','),							'3'=>number_format($thirthy1_to_sixty, 2, '.', ','),							'4'=>number_format($sixty1_to_ninety, 2, '.', ','),							'5'=>number_format($ninety_plus, 2, '.', ','),							'6'=>$this->generate_table($result,$array));			echo json_encode($data);		}		else			echo 0;	}		public function by_Supplier(){		$data = $this->input->post();		$result = $this->md_ap_aging->by_Supplier($data['Supplier'],$data['checked'],$data['Main']);		$table = null;$total = 0;$current=0;$one_to_thirty=0;$thirthy1_to_sixty=0;$sixty1_to_ninety=0;$ninety_plus=0;		if($result){			foreach($result as $i){				$total+=$i['TOTAL'];				$current+=$i['CURRENT'];				$one_to_thirty+=$i['1-30'];				$thirthy1_to_sixty+=$i['31-60'];				$sixty1_to_ninety+=$i['61-90'];				$ninety_plus+=$i['90+'];			}			$array = array ('REF. #',							'DATE',							'DUE DATE',							'CURRENT',							'1-30',							'31-60',							'61-90',							'90+',							'TOTAL');			$data = array( '0'=>number_format($total, 2, '.', ','),							'1'=>number_format($current, 2, '.', ','),							'2'=>number_format($one_to_thirty, 2, '.', ','),							'3'=>number_format($thirthy1_to_sixty, 2, '.', ','),							'4'=>number_format($sixty1_to_ninety, 2, '.', ','),							'5'=>number_format($ninety_plus, 2, '.', ','),							'6'=>$this->generate_table($result,$array));			echo json_encode($data);		}		else			return false;	}		public function generate_table($array=null,$hide=array()){		$table=null;		$table = "<table class='table table-bordered table-items'>";			$table .= "<thead>";				$table .= "<tr>";				foreach($array[0] as $key=>$pair)					$table .= (!in_array($key,$hide))? "<th class='".$key."' style='display:none;'>".$key."</th>" : "<th class='".$key."'>".$key."</th>";					$table .= "</tr>";			$table .= "</thead>";			$table .= "<tbody>";				foreach($array as $arr){					$table .= "<tr>";					foreach($arr as $key => $pair){						if($key == "TOTAL" || $key == "1-30" || $key == "31-60" || $key == "61-90" || $key == "90+" || $key == "CURRENT")							$table .= (!in_array($key,$hide)) ? "<td class='".$key."' style='display:none;'>".number_format($arr[$key],2,'.',',')."</td>" : "<td class='".$key."'>".number_format($arr[$key],2,'.',',')."</td>";								else 							$table .= (!in_array($key,$hide)) ? "<td class='".$key."' style='display:none;'>".$arr[$key]."</td>" : "<td class='".$key."'>".$arr[$key]."</td>";							}					$table .= "</tr>";					}			$table .= "</tbody>";		$table .= "</table>";		return $table;	}	}